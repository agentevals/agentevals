# Rubric Evaluator Example
# Demonstrates structured rubrics with weights and score ranges

name: code-review-rubric
version: "1.0"
description: Evaluates code review quality using structured rubrics

metadata:
  author: agentevals
  tags: [example, rubric, code-review]
  skill: code-review

execution:
  evaluators:
    - name: review_quality
      type: rubric
      rubrics:
        - id: bug-identification
          expected_outcome: Correctly identifies bugs and issues
          weight: 3.0
          required: true
          score_ranges:
            0: Misses critical bugs
            3: Identifies some issues but misses important ones
            5: Identifies most bugs
            7: Identifies all major bugs with minor omissions
            10: Complete and accurate bug identification

        - id: fix-quality
          expected_outcome: Provides correct and practical fixes
          weight: 2.0
          score_ranges:
            0: Fixes are incorrect or would introduce new bugs
            5: Fixes work but are not optimal
            10: Fixes are correct, elegant, and follow best practices

        - id: explanation
          expected_outcome: Explains issues clearly
          weight: 1.0
          score_ranges:
            0: No explanation or unclear
            5: Basic explanation
            10: Clear, educational explanation

evalcases:
  - id: off-by-one-error
    expected_outcome: |
      Identifies the off-by-one error in the loop condition
      and provides the correct fix with clear explanation.

    input:
      - role: user
        content: |
          Review this JavaScript function:
          ```javascript
          function sumArray(arr) {
            let sum = 0;
            for (let i = 0; i <= arr.length; i++) {
              sum += arr[i];
            }
            return sum;
          }
          ```

    rubrics:
      - id: identifies-bounds-error
        expected_outcome: Identifies the i <= arr.length should be i < arr.length
        weight: 3.0
        required: true

      - id: explains-undefined
        expected_outcome: Explains that arr[arr.length] is undefined
        weight: 2.0

      - id: correct-fix
        expected_outcome: Provides the corrected code
        weight: 2.0

  - id: security-vulnerability
    expected_outcome: |
      Identifies SQL injection vulnerability and recommends
      parameterized queries.

    input:
      - role: user
        content: |
          Review this Python code:
          ```python
          def get_user(user_id):
              query = f"SELECT * FROM users WHERE id = {user_id}"
              return db.execute(query)
          ```

    rubrics:
      - id: identifies-sqli
        expected_outcome: Identifies SQL injection risk
        weight: 4.0
        required: true

      - id: suggests-params
        expected_outcome: Recommends parameterized queries
        weight: 3.0

      - id: explains-risk
        expected_outcome: Explains potential impact of SQL injection
        weight: 1.0
